<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Cross Check Arena303</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Styles -->
<style>
/* Body & background */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    color: #e5e7eb;
    background: url('https://cdn.areabermain.club/assets/cdn/az6/2026/01/12/20260112/f32535f496d3334f2061bf124fb3bebf/arena303-backgroundweb.jpg') no-repeat center center fixed;
    background-size: cover;
}

/* Logo */
.logo-container {
    text-align: center;
    margin-bottom: 20px;
}
.logo-container img {
    max-width: 220px;
}

/* Header teks dengan gradient & shadow */
.header-text {
    width: 100%;
    text-align: center;
    padding: 14px 0;
    border-radius: 12px;
    margin-bottom: 20px;
    background: linear-gradient(90deg, #0f172a, #1e293b);
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}
.header-text h2, .header-text p {
    color: #fff;
    margin: 4px 0;
    text-shadow: 2px 2px 6px rgba(0,0,0,0.7);
    font-weight: bold;
}

/* Container input area */
.container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
}

/* Label textarea */
.container b {
    display: block;
    font-size: 16px;
    font-weight: bold;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
    margin-bottom: 10px;
    border-bottom: 1px solid rgba(255,255,255,0.3);
    padding-bottom: 4px;
}

/* Textarea */
textarea {
    width: 100%;
    height: 220px;
    padding: 14px;
    border-radius: 8px;
    border: none;
    font-size: 14px;
    background: rgba(0,0,0,0.7);
    color: #fff;
    resize: none;
}
textarea::placeholder { color: #ccc; }

/* Tombol dengan gradient */
button {
    margin-top: 10px;
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    background: linear-gradient(90deg, #16a34a, #22c55e);
    color: #000;
    box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    transition: all 0.3s ease;
}
button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 10px rgba(0,0,0,0.4);
}

/* Input search */
#searchBox {
    margin-top: 10px;
    padding: 6px 12px;
    border-radius: 6px;
    border: none;
    width: 100%;
    max-width: 300px;
    font-size: 13px;
}

/* Counter total */
#counter {
    margin-top: 10px;
    font-weight: bold;
    font-size: 14px;
}

/* Table */
table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
    background: rgba(0,0,0,0.85);
    border-radius: 8px;
    overflow: hidden;
    transition: all 0.3s ease;
}
th, td {
    border: 1px solid rgba(255,255,255,0.2);
    padding: 12px 16px;
    font-size: 14px;
}
th { background: rgba(255,255,255,0.15); font-weight: bold; }

/* Status colors dengan gradient lembut */
.off { 
    background: linear-gradient(90deg, #7f1d1d, #991b1b);
    color: #fff; 
    font-weight: bold; 
}
.notfound { 
    background: linear-gradient(90deg, #d97706, #b45309);
    color: #000; 
    font-weight: bold; 
}

/* Hover row */
#hasil tbody tr:hover {
    background: rgba(255,255,255,0.1);
    transform: scale(1.01);
    transition: all 0.2s ease;
}
</style>
</head>

<body>

<!-- Logo -->
<div class="logo-container">
    <img src="https://cdn.areabermain.club/assets/cdn/az6/2026/01/12/20260112/2760b364348644bfec96ec1f8b4676fe/arena303-logo-fix-besar.png" alt="Arena303 Logo">
</div>

<!-- Header -->
<div class="header-text">
    <h2>Cross Check Rekening Bermasalah</h2>
    <p>Bandingkan rekening bermasalah dari ADM dengan rekening aktif perusahaan</p>
</div>

<!-- Input -->
<div class="container">
    <div>
        <b>Rekening Aktif Perusahaan</b>
        <textarea id="adm" placeholder="Tempel data dari ADM di sini"></textarea>
    </div>
    <div>
        <b>Rekening Bermasalah dari ADM</b>
        <textarea id="aktif" placeholder="Tempel data rekening aktif perusahaan"></textarea>
    </div>
</div>

<!-- Tombol & Search -->
<button onclick="proses()">Proses Cek</button>
<button onclick="copyCSV()">Copy Rekening HARUS DI-OFF</button>
<br>
<input type="text" id="searchBox" placeholder="Cari nomor rekening..." oninput="searchTable()">

<div id="counter"></div>

<!-- Table hasil -->
<table id="hasil">
    <thead>
        <tr>
            <th>Bank</th>
            <th>Nama Rekening</th>
            <th>No Rekening</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<!-- Script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
// Parsing rekening
function ambilRekening(teks) {
    const map = new Map();
    teks.split("\n").forEach(baris => {
        baris = baris.trim();
        if (!baris) return;
        const parts = baris.split(/\s+/);
        if (parts.length < 2) return;
        const norek = parts.pop().replace(/\D/g,'');
        const bank = parts.shift();
        const nama = parts.join(" ") || "-";
        if (norek) map.set(norek, { bank, nama, norek });
    });
    return map;
}

// Proses cross-check
function proses() {
    const aktifText = document.getElementById("aktif").value;
    const admText = document.getElementById("adm").value;
    const tbody = document.querySelector("#hasil tbody");
    tbody.innerHTML = "";

    const aktifMap = ambilRekening(aktifText);
    let harusOff = [];
    let tidakAda = [];

    admText.split("\n").forEach(baris => {
        baris = baris.trim();
        if (!baris) return;
        const norek = baris.replace(/\D/g,'');
        if (!norek) return;
        if (aktifMap.has(norek)) {
            const data = aktifMap.get(norek);
            harusOff.push(`<tr class="off"><td>${data.bank}</td><td>${data.nama}</td><td>${data.norek}</td><td>❌ SEGERA OFFKAN DAN MINIMKAN SALDO NYA</td></tr>`);
        } else {
            tidakAda.push(`<tr class="notfound"><td>-</td><td>-</td><td>${norek}</td><td>⚠️ REKENING AMAN DAN TETAP DI GUNAKAN</td></tr>`);
        }
    });

    tbody.innerHTML = harusOff.join('') + tidakAda.join('');
    document.getElementById("counter").innerText = `Total HARUS DI-OFF: ${harusOff.length}`;
    tbody.scrollIntoView({behavior:'smooth'});
}

// Copy HARUS DI-OFF
function copyCSV() {
    let csv = [];
    const header = document.querySelectorAll("#hasil thead th");
    csv.push([...header].map(h=>`"${h.innerText}"`).join(','));
    document.querySelectorAll("#hasil tbody tr.off").forEach(row=>{
        const cols = row.querySelectorAll("td");
        csv.push([...cols].map(c=>`"${c.innerText}"`).join(','));
    });
    if(csv.length===1){alert("Tidak ada rekening yang harus di-OFF"); return;}
    navigator.clipboard.writeText(csv.join("\n")).then(()=>alert("Rekening HARUS DI-OFF berhasil di-copy"));
}

// Search cepat
function searchTable() {
    const input = document.getElementById("searchBox").value.trim();
    const rows = document.querySelectorAll("#hasil tbody tr");
    rows.forEach(row => {
        const norek = row.cells[2].innerText;
        row.style.display = norek.includes(input) ? "" : "none";
    });
}

// Export Excel
function exportExcel() {
    const table = document.getElementById("hasil");
    const wb = XLSX.utils.table_to_book(table, {sheet:"Sheet1"});
    XLSX.writeFile(wb,"Rekening_Harus_DiOff.xlsx");
}

// Tambahkan tombol export
const exportBtn = document.createElement("button");
exportBtn.innerText = "Export Excel HARUS DI-OFF";
exportBtn.style.marginTop = "10px";
exportBtn.onclick = exportExcel;
document.body.insertBefore(exportBtn, document.getElementById("counter").nextSibling);
</script>

</body>
</html>

